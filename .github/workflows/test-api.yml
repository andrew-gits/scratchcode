name: API tests
run-name: Running API tests
on: [push]
jobs:
  Test-API:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Create some files to store credentials needed to run the containers
        run: mkdir db
      - run: echo ${{ secrets.DB_PASSWORD }} > db/password.txt
      - run: echo ${{ secrets.VERCEL_TOKEN }} > vercel.txt
      - run: mkdir app/.vercel
      - run: echo ${{ secrets.VERCEL_LINK }} > app/.vercel/project.json
      - name: Build the stack
        run: ./dev-up.bash
      - name: Test
        run: ls -lah
      - run: whoami
      - run: docker exec -it cd /node/backend && ./run_tests.bash
